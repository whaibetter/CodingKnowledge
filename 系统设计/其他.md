### 过滤器、拦截器、切面的区别？场景？

> #### 过滤器（Filter）
>
> - Servlet中的技术，**预处理**
> - 请求参数处理、字符编码转换、敏感词汇、对web服务器管理的所有web资源：例如Jsp, Servlet, 静态图片文件或静态 html 文件等进行拦截。
> - 可在web.xml中配置
>
> #### 拦截器（Interceptor）
>
> - 属于SpringMVC；拦截器可以**获取IOC容器中的各个bean**，而过滤器就不行
> - 基于Java反射创建
>
> #### 切面Aspect
>
> - 属于Spring
> - 适用于关注**多个类和方法**，如日志记录、性能监控、事务管理。
>
> ![在这里插入图片描述](http://42.192.130.83:9000/picgo/imgs/20200602173814901.png)
>
> #### 区别
>
> 1. 拦截器不依赖与servlet容器是SpringMVC自带的，**过滤器依赖于Servlet容器**。
> 2. 拦截器是基于java的反射机制的，而过滤器是基于函数回调。
> 3. 拦截器只能对action请求起作用，而过滤器则可以对几乎所有的请求起作用。

#### Filter

- 注册Filter Bean

```java
public class MyFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
            throws IOException, ServletException {
        // 这里可以编写过滤器的逻辑
        // ...

        chain.doFilter(request, response);
    }

    // 可以实现其他方法，如init和destroy

}
```

```java
@Configuration
public class FilterConfig {

    @Bean
    public FilterRegistrationBean<MyFilter> myFilter() {
        FilterRegistrationBean<MyFilter> registrationBean = new FilterRegistrationBean<>();
        registrationBean.setFilter(new MyFilter());
        registrationBean.addUrlPatterns("/*"); // 设置过滤器的URL模式
        registrationBean.setOrder(1); // 设置过滤器的执行顺序
        return registrationBean;
    }

}
```

- @WebFilter

```java
@WebFilter(urlPatterns = "/*")
public class MyFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
            throws IOException, ServletException {
        // 这里可以编写过滤器的逻辑
        // ...

        chain.doFilter(request, response);
    }

    // 可以实现其他方法，如init和destroy
}
```

#### Interceptor 

- 配置到WebMvcConfigurer

```java
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.stereotype.Component;
import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.ModelAndView;

@Component
public class MyInterceptor implements HandlerInterceptor {
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler)
            throws Exception {
        // 在请求处理之前执行的逻辑
        // 返回true表示继续处理，返回false表示中断请求
        return true;
    }

    @Override
    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler,
                           ModelAndView modelAndView) throws Exception {
        // 在请求处理之后、视图渲染之前执行的逻辑
    }

    @Override
    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler,
                                Exception ex) throws Exception {
        // 在整个请求完成之后执行的逻辑
    }
}
```

```java
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
public class InterceptorConfig implements WebMvcConfigurer {

    private final MyInterceptor myInterceptor;

    @Autowired
    public InterceptorConfig(MyInterceptor myInterceptor) {
        this.myInterceptor = myInterceptor;
    }

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(myInterceptor)
                .addPathPatterns("/**") // 设置拦截的路径
                .excludePathPatterns("/public/**"); // 设置排除的路径
    }
}
```



1. 过滤器（Filter）：
   过滤器是一种用于在请求进入或响应离开应用程序时进行处理的组件。它们通常用于在请求到达目标之前或响应到达客户端之前，对请求或响应进行预处理或后处理。过滤器常见的应用场景包括请求参数处理、字符编码转换、请求鉴权等。过滤器通常是基于Servlet规范的一部分，在Java Web开发中比较常见。
2. 拦截器（Interceptor）：
   拦截器也是一种用于在请求进入或响应离开应用程序时进行处理的组件，类似于过滤器。拦截器通常用于在请求进入或离开控制器（或处理程序）之前对其进行预处理或后处理。拦截器通常与特定的框架或应用程序上下文相关联，例如Spring框架中的拦截器可以实现日志记录、权限验证等功能。
3. 切面（Aspect）：
   切面是一种更加通用的概念，它用于描述跨越多个对象或组件的关注点。切面关注的是系统中的横切关注点，例如日志记录、事务管理等。切面可以通过在目标对象的方法执行前、执行后或异常处理时插入代码逻辑，实现这些横切关注点的功能。切面通常与面向切面编程（AOP）相关联，AOP框架（如Spring AOP）可以通过代理机制实现切面的功能。